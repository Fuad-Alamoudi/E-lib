define(["jquery","sweetalert2","confirm"],function($j,swal){function searchIdAndSendAjax(event){var element=Event.element(event),productStatus=element.getAttribute("data-product-status"),productDataLayer=element.getAttribute("data-layer"),productType=element.getAttribute("data-product-type"),addToLinc="add-to-links",renewedItemKey="31",oldEvent=element.getAttribute("oldEvent"),agreeBtn=$j("#renewed-items-modal-agree"),idProduct=parseInt(element.getAttribute("data-product-id"))||!1,withTotalProtectionBtn=$j("#add-with-total-protection"),withoutTotalProtectionBtn=$j("#add-without-total-protection"),totalProtectionImage=$j("#total-protection-image"),totalProtectionContent=$j("#total-protection-content"),hasTotalProtection=element.getAttribute("data-total-protection"),digitalProductContent=$j("#digital-items-content"),digitalAgreeBtn=$j("#digital-items-modal-agree");event.preventDefault();var qtyField=$j("#qty-"+idProduct);if(0<qtyField.length){var qtyValue=qtyField.val();if(minimumQtyAllowed=parseInt(qtyField.prop("step")),qtyIncrements=parseInt(qtyField.prop("min")),0<minimumQtyAllowed&&qtyValue<minimumQtyAllowed)return console.log("less than"+minimumQtyAllowed),swal({text:Translator.translate("The minimum quantity for purchase is ")+minimumQtyAllowed,type:"info",confirmButtonText:Translator.translate("Continue")});if(0<qtyIncrements&&0<qtyValue%qtyIncrements)return console.log("This"+qtyIncrements),swal({text:Translator.translate("This product is available for purchase in increments of ")+qtyIncrements+Translator.translate(" only"),type:"info",confirmButtonText:Translator.translate("Continue")})}if($("confirmBox")&&jQuery(function(t){t.confirm.hide()}),"SPAN"==element.tagName&&(element=element.up("button")),(amconf=element.getAttribute("amconf"))&&eval(amconf),productStatus===renewedItemKey){var $renewedModal=$j("#renewed-items-modal");$renewedModal.modal(),agreeBtn.bind("click.addtocart",function(){return AmAjaxObj.sendAjax(idProduct,"",oldEvent,this),agreeBtn.unbind("click.addtocart"),!1})}else if(null!=hasTotalProtection&&""!=hasTotalProtection.trim()||"digital"!=productType)if(null!==hasTotalProtection&&""!==hasTotalProtection.trim()){var totalProtectionProductImage=$j("#total-protection-image-"+idProduct).html(),totalProtectionProductContent=$j("#total-protection-content-"+idProduct).html(),totalProtectionProductName=$j("#total-protection-name-"+idProduct),totalProtectionProductDataLayer=totalProtectionProductName.attr("data-layer"),qtyField=$j("#product_addtocart_form .qty");productDataLayer=JSON.parse(productDataLayer);var productDataLayerId=productDataLayer.ecommerce.add.products[0].id;productDataLayer.ecommerce.add.products[0]=GoogleTagManager.getUpdatedItemBySku(productDataLayerId),totalProtectionProductDataLayer=JSON.parse(totalProtectionProductDataLayer);var totalProtectionProductDataLayerId=totalProtectionProductDataLayer.ecommerce.add.products[0].id;totalProtectionProductDataLayer.ecommerce.add.products[0]=GoogleTagManager.getUpdatedItemBySku(totalProtectionProductDataLayerId),withTotalProtectionBtn.html(totalProtectionProductName.html()),withTotalProtectionBtn.attr("data-protection-id",totalProtectionProductName.data("protection-id")),totalProtectionImage.html(totalProtectionProductImage),totalProtectionContent.html(totalProtectionProductContent);var $totalProtectionModal=$j("#total-protection-modal"),deviceLabel=$j(".total-protection__device");function sendAndUnbindWithoutTotal(){return AmAjaxObj.sendAjax(idProduct,"",oldEvent,this),withTotalProtectionBtn.unbind("click.addtocart"),withoutTotalProtectionBtn.unbind("click.addtocart"),dataLayer.push(productDataLayer),!1}function sendAndUnbindWithTotal(){return AmAjaxObj.sendAjax(idProduct,"",oldEvent,this),withTotalProtectionBtn.unbind("click.addtocart"),withoutTotalProtectionBtn.unbind("click.addtocart"),productDataLayer.ecommerce.add.products.push(totalProtectionProductDataLayer.ecommerce.add.products[0]),dataLayer.push(productDataLayer),!1}0<qtyField.length&&1<qtyField.val()?deviceLabel.css("display","block"):deviceLabel.css("display","none"),withTotalProtectionBtn.bind("click.addtocart",sendAndUnbindWithTotal),withoutTotalProtectionBtn.bind("click.addtocart",sendAndUnbindWithoutTotal),$totalProtectionModal.modal({body:"#product_addtocart_form"})}else{if(0<idProduct)return AmAjaxObj.sendAjax(idProduct,"",oldEvent,element),!0;var i=0;for(el=element;!idProduct&&i<5;)if(el=$(el.parentNode),i++,el){var idProduct=AmAjaxObj.searchInPriceBox(el,oldEvent,element,idProduct);if(idProduct)return!1}var el=$(element.parentNode),child=el.getElementsByClassName(addToLinc)[0];if(child){var childNext=child.childElements()[0];if(childNext)var childNext=childNext.childElements()[0];if(childNext)var idProduct=childNext.href.match(/product(.*?)form_key/)[0].replace(/[^\d]/gi,"");if(0<parseInt(idProduct)){var tmp=parseInt(idProduct);return AmAjaxObj.sendAjax(tmp,"",oldEvent,element),!0}idProduct=!1}if(idProduct)return!1;if($$("input[name='product']")[0]&&$$("input[name='product']")[0].value&&(idProduct=$$("input[name='product']")[0].value,0<parseInt(idProduct))){var tmp=parseInt(idProduct);return AmAjaxObj.sendAjax(tmp,"",oldEvent,element),!0}if(idProduct)return!1;if(""==idProduct&&oldEvent){var productString="/product/",posStart=oldEvent.indexOf(productString);if(posStart){var posFinish=oldEvent.indexOf("/",posStart+productString.length);if(posFinish){var idProduct=oldEvent.substring(posStart+productString.length,posFinish);if(0<parseInt(idProduct)){var tmp=parseInt(idProduct);return AmAjaxObj.sendAjax(tmp,"",oldEvent,element),!1}idProduct=!1}}}if(idProduct)return!1;document.all&&!document.querySelector&&(oldEvent=oldEvent.substring(21,oldEvent.length-2)),eval(oldEvent)}else{var digitalItemContent=$j("#digital-item-content-"+idProduct).html();digitalProductContent.html(digitalItemContent);var $digitalModal=$j("#digital-items-modal");$digitalModal.modal(),digitalAgreeBtn.bind("click.addtocart",function(){return AmAjaxObj.sendAjax(idProduct,"",oldEvent,this),digitalAgreeBtn.unbind("click.addtocart"),!1})}}function searchIdAndlinkCompare(t){var e=Event.element(t);t.preventDefault(),"SPAN"==e.tagName&&(e=e.up("a"));var o=e.getAttribute("data-attribute"),a=e.getAttribute("data-sku"),r=Mage.Cookies.get("catalog-compare"),n=new Date((new Date).getTime()+864e5),i=[];if(r){if((r=JSON.parse(r)).attribute!==o)return swal({text:window.Translator.translate("You cannot compare this product with the items in the comparison list."),type:"error",confirmButtonText:window.Translator.translate("Continue")});if(3<r.sku.length)return swal({text:window.Translator.translate("No more than 4 items can be added for comparison."),type:"error",confirmButtonText:window.Translator.translate("Continue")});for(var d=0;d<r.sku.length;d++)if(r.sku[d]===a)return swal({text:window.Translator.translate("This product is already in your comparison list."),type:"warning",confirmButtonText:window.Translator.translate("Continue")});i=r.sku}i.push(a),Mage.Cookies.set("catalog-compare",JSON.stringify({sku:i,attribute:o}),n),CompareEventBus&&CompareEventBus.$emit("CHANGE_COMPARED_PRODUCT")}function searchIdWishlist(t){var e=Event.element(t);t.preventDefault();var o,a=!1;"SPAN"==e.tagName&&(e=e.up("a")),!e.href||""==e.href||(o=e.href.match(/product\/(.*?)\//))&&void 0!==o[0]&&(a=o[0].replace(/[^\d]/gi,""));!a&&e.getAttribute("onclick")&&""!=e.getAttribute("onclick")&&(o=e.getAttribute("onclick").match(/product\/(.*?)\//))&&void 0!==o[0]&&(a=o[0].replace(/[^\d]/gi,""));0<(a=a||AmAjaxObj.getProductId(e.up(".item, #product_addtocart_form")))&&AmAjaxObj.sendWishlistAjax(a,e)}function AmAjaxShoppCartLoad(t){"undefined"==typeof AmAjaxObj||$$("body").first().hasClassName("checkout-cart-configure")||(t=t||AmAjaxObj.options.buttonClass,$$(t).each(function(t){if(!t.hasClassName("amcart-ignore")){if(t.getAttribute("onclick")){var e=document.createAttribute("oldEvent");e.value=t.getAttribute("onclick").toString(),t.attributes.setNamedItem(e)}t.onclick="",t.stopObserving("click"),t.removeAttribute("onclick"),t.removeAttribute("disabled"),Event.observe(t,"click",searchIdAndSendAjax),t.addClassName("amcart-ignore")}}.bind(this)),AmAjaxObj.options.linkcompare&&$$(".add-to-links__link--compare").each(function(t){t.stopObserving("click"),t.removeAttribute("onclick"),Event.observe(t,"click",searchIdAndlinkCompare)}.bind(this)),AmAjaxObj.options.wishlist&&$$('a[href*="wishlist/index/add"]').each(function(t){t.stopObserving("click"),t.removeAttribute("onclick"),Event.observe(t,"click",searchIdWishlist)}.bind(this)))}return AmAjaxShoppCartLoad});